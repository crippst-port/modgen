<div class="aiplacement-modgen-preview">
    {{#notifications}}
    <div class="{{classes}}" role="alert">{{message}}</div>
    {{/notifications}}

    {{#hasprompt}}
    <section class="aiplacement-modgen-preview__prompt">
        <h3>{{promptheading}}</h3>
        <div id="aiplacement-modgen-prompt">
            <div class="aiplacement-modgen-preview__prompt-body">
                <p>{{prompttext}}</p>
            </div>
        </div>
    </section>
    {{/hasprompt}}

    {{#modulepreview}}
    <h2>Module Structure</h2>
    <div class="aiplacement-modgen-preview__summary mb-4">
        <p>{{modulestructureinfo}}</p>
    </div>
    <section class="aiplacement-modgen-preview__module">
        
        <p class="aiplacement-modgen-legend">
            <strong>Key:</strong>
            <i class="fa fa-folder" style="color: #4055cc;"></i> Theme,
            <i class="fa fa-calendar" style="color: #764ba2;"></i> Week,
            <i class="fa fa-graduation-cap" style="color: #4055cc;"></i> Session
        </p>
        
        {{#hasthemes}}
        <div class="aiplacement-modgen-module-structure">
            {{#themes}}
            <details class="aiplacement-modgen-theme-details" open>
                <summary class="aiplacement-modgen-theme-summary">
                    <i class="fa fa-folder aiplacement-modgen-theme-icon"></i>
                    <span class="aiplacement-modgen-theme-title">{{title}}</span>
                </summary>
                <div class="aiplacement-modgen-theme-content">
                    {{#summary}}<p class="aiplacement-modgen-theme__summary">{{summary}}</p>{{/summary}}
                    
                    {{#hasweeks}}
                    <div class="aiplacement-modgen-theme__weeks">
                        {{#weeks}}
                        <details class="aiplacement-modgen-week-details">
                            <summary class="aiplacement-modgen-week-summary">
                                <i class="fa fa-calendar aiplacement-modgen-week-icon"></i>
                                <span class="aiplacement-modgen-week-title">{{title}}</span>
                            </summary>
                            <div class="aiplacement-modgen-week-content">
                                {{#summary}}<p class="aiplacement-modgen-week__summary">{{summary}}</p>{{/summary}}
                                
                                {{#hassessions}}
                                <div class="aiplacement-modgen-week__sessions">
                                    {{#sessions}}
                                    <div class="aiplacement-modgen-session">
                                        <div class="aiplacement-modgen-session-header">
                                            <i class="fa fa-graduation-cap" style="color: #4055cc;"></i>
                                            <span>{{label}}</span>
                                        </div>
                                        <div class="aiplacement-modgen-session-content">
                                            {{#activities}}
                                            <div class="aiplacement-modgen-activity">
                                                <i class="fa fa-pencil aiplacement-modgen-activity__icon" style="color: #4055cc;"></i>
                                                <div class="aiplacement-modgen-activity__content">
                                                    <span class="aiplacement-modgen-activity__name">{{name}}</span>
                                                    {{#type}}<span class="aiplacement-modgen-activity__type">({{type}})</span>{{/type}}
                                                </div>
                                            </div>
                                            {{/activities}}
                                            {{^activities}}
                                            <p class="aiplacement-modgen-activity-none">No activities</p>
                                            {{/activities}}
                                        </div>
                                    </div>
                                    {{/sessions}}
                                </div>
                                {{/hassessions}}
                                
                                {{#hasactivities}}
                                {{^hassessions}}
                                <div class="aiplacement-modgen-week__activities">
                                    {{#activities}}
                                    <div class="aiplacement-modgen-activity">
                                        <i class="fa fa-pencil aiplacement-modgen-activity__icon" style="color: #4055cc;"></i>
                                        <div class="aiplacement-modgen-activity__content">
                                            <span class="aiplacement-modgen-activity__name">{{name}}</span>
                                            {{#type}}<span class="aiplacement-modgen-activity__type">({{type}})</span>{{/type}}
                                        </div>
                                    </div>
                                    {{/activities}}
                                </div>
                                {{/hassessions}}
                                {{/hasactivities}}
                                {{^hasactivities}}
                                {{^hassessions}}
                                <p class="aiplacement-modgen-activity-none">No activities in this week</p>
                                {{/hassessions}}
                                {{/hasactivities}}
                            </div>
                        </details>
                        {{/weeks}}
                    </div>
                    {{/hasweeks}}
                </div>
            </details>
            {{/themes}}
        </div>
        {{/hasthemes}}

        {{^hasthemes}}
        {{#hasweeks}}
        <div class="aiplacement-modgen-module-structure">
            {{#weeks}}
            <details class="aiplacement-modgen-week-details" open>
                <summary class="aiplacement-modgen-week-summary">
                    <i class="fa fa-calendar aiplacement-modgen-week-icon"></i>
                    <span class="aiplacement-modgen-week-title">{{title}}</span>
                </summary>
                <div class="aiplacement-modgen-week-content">
                    {{#summary}}<p class="aiplacement-modgen-week__summary">{{summary}}</p>{{/summary}}
                    
                    {{#hassessions}}
                    <div class="aiplacement-modgen-week__sessions">
                        {{#sessions}}
                        <div class="aiplacement-modgen-session-header">
                            <i class="fa fa-graduation-cap" style="color: #4055cc;"></i>
                            <span>{{label}}</span>
                        </div>
                        {{/sessions}}
                    </div>
                    {{/hassessions}}
                    
                    {{#hasactivities}}
                    <div class="aiplacement-modgen-week__activities">
                        {{#activities}}
                        <div class="aiplacement-modgen-activity">
                            <i class="fa fa-pencil aiplacement-modgen-activity__icon" style="color: #4055cc;"></i>
                            <div class="aiplacement-modgen-activity__content">
                                <span class="aiplacement-modgen-activity__name">{{name}}</span>
                                {{#type}}<span class="aiplacement-modgen-activity__type">({{type}})</span>{{/type}}
                            </div>
                        </div>
                        {{/activities}}
                    </div>
                    {{/hasactivities}}
                    {{^hasactivities}}
                    <p class="aiplacement-modgen-activity-none">No activities in this week</p>
                    {{/hasactivities}}
                </div>
            </details>
            {{/weeks}}
        </div>
        {{/hasweeks}}
        {{/hasthemes}}

        {{^hasthemes}}
        {{^hasweeks}}
        <p class="alert alert-warning">No module structure data available. The AI response may be incomplete.</p>
        {{/hasweeks}}
        {{/hasthemes}}
        {{#hasjson}}
    
        <p class="text-right">
            <a href="data:application/json;charset=utf-8,{{{json}}}" download="module-structure.json">
                Download as JSON
            </a>
        </p>
    
    {{/hasjson}}
    </section>
    {{/modulepreview}}

    
    
    {{{form}}}
</div>
