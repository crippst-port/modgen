<div class="aiplacement-modgen-preview">
    {{#notifications}}
    <div class="{{classes}}" role="alert">{{message}}</div>
    {{/notifications}}

    {{#hasprompt}}
    <section class="aiplacement-modgen-preview__prompt">
        <h3>{{promptheading}}</h3>
        <div id="aiplacement-modgen-prompt">
            <div class="aiplacement-modgen-preview__prompt-body">
                <p>{{prompttext}}</p>
            </div>
        </div>
    </section>
    {{/hasprompt}}

    {{#hassummary}}
    <section>
        <h3>{{summaryheading}}</h3>
        <p class="aiplacement-modgen-preview__summary">{{{summary}}}</p>
    </section>
    {{/hassummary}}

    {{#modulepreview}}
    <section class="aiplacement-modgen-preview__module">
        <h3>üìö Module Structure</h3>
        
        {{#hasthemes}}
        <div class="aiplacement-modgen-module-structure">
            {{#themes}}
            <div class="aiplacement-modgen-theme">
                <div class="aiplacement-modgen-theme__header">
                    <h4 class="aiplacement-modgen-theme__title">üìÇ {{title}}</h4>
                    {{#summary}}<p class="aiplacement-modgen-theme__summary">{{summary}}</p>{{/summary}}
                </div>
                
                {{#hasweeks}}
                <div class="aiplacement-modgen-theme__weeks">
                    {{#weeks}}
                    <div class="aiplacement-modgen-week">
                        <div class="aiplacement-modgen-week__header">
                            <h5 class="aiplacement-modgen-week__title">üìÖ {{title}}</h5>
                            {{#summary}}<p class="aiplacement-modgen-week__summary">{{summary}}</p>{{/summary}}
                        </div>
                        
                        {{#hasactivities}}
                        <div class="aiplacement-modgen-week__activities">
                            {{#activities}}
                            <div class="aiplacement-modgen-activity">
                                <span class="aiplacement-modgen-activity__icon">üîπ</span>
                                <div class="aiplacement-modgen-activity__content">
                                    <span class="aiplacement-modgen-activity__name">{{name}}</span>
                                    {{#type}}<span class="aiplacement-modgen-activity__type">({{type}})</span>{{/type}}
                                    {{#session}}<span class="aiplacement-modgen-activity__session">{{session}}</span>{{/session}}
                                </div>
                            </div>
                            {{/activities}}
                        </div>
                        {{/hasactivities}}
                        {{^hasactivities}}
                        <p class="aiplacement-modgen-activity-none">No activities in this week</p>
                        {{/hasactivities}}
                    </div>
                    {{/weeks}}
                </div>
                {{/hasweeks}}
            </div>
            {{/themes}}
        </div>
        {{/hasthemes}}

        {{^hasthemes}}
        {{#hasweeks}}
        <div class="aiplacement-modgen-module-structure">
            {{#weeks}}
            <div class="aiplacement-modgen-week">
                <div class="aiplacement-modgen-week__header">
                    <h4 class="aiplacement-modgen-week__title">üìÖ {{title}}</h4>
                    {{#summary}}<p class="aiplacement-modgen-week__summary">{{summary}}</p>{{/summary}}
                </div>
                
                {{#hasactivities}}
                <div class="aiplacement-modgen-week__activities">
                    {{#activities}}
                    <div class="aiplacement-modgen-activity">
                        <span class="aiplacement-modgen-activity__icon">üîπ</span>
                        <div class="aiplacement-modgen-activity__content">
                            <span class="aiplacement-modgen-activity__name">{{name}}</span>
                            {{#type}}<span class="aiplacement-modgen-activity__type">({{type}})</span>{{/type}}
                        </div>
                    </div>
                    {{/activities}}
                </div>
                {{/hasactivities}}
                {{^hasactivities}}
                <p class="aiplacement-modgen-activity-none">No activities in this week</p>
                {{/hasactivities}}
            </div>
            {{/weeks}}
        </div>
        {{/hasweeks}}
        {{/hasthemes}}

        {{^hasthemes}}
        {{^hasweeks}}
        <p class="alert alert-warning">No module structure data available. The AI response may be incomplete.</p>
        {{/hasweeks}}
        {{/hasthemes}}
    </section>
    {{/modulepreview}}

    {{#hasjson}}
    <section class="aiplacement-modgen-preview__json">
        <h3>{{jsonheading}}</h3>
        <p class="aiplacement-modgen-preview__json-description">{{jsondescription}}</p>
        <div class="aiplacement-modgen-json-controls">
            <button class="btn btn-sm btn-outline-secondary" id="aiplacement-modgen-download-json" data-json="{{{json}}}">
                üíæ {{downloadjsontext}}
            </button>
            <button class="btn btn-sm btn-outline-secondary" id="aiplacement-modgen-view-json">
                üëÅÔ∏è View JSON
            </button>
        </div>
        <div id="aiplacement-modgen-json-viewer" class="aiplacement-modgen-json-viewer" style="display: none;">
            <pre><code id="aiplacement-modgen-json-code">{{{json}}}</code></pre>
        </div>
        <p class="aiplacement-modgen-preview__json-note">{{jsonnote}}</p>
    </section>
    {{/hasjson}}
    
    {{{form}}}
</div>
